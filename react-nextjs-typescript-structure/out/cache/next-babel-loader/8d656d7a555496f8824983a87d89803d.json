{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/esm/asyncToGenerator\";\nvar __jsx = React.createElement;\nimport React, { useEffect, useState } from 'react';\nimport axios from 'axios';\nimport { Container, CardContent } from '../styles/pages/Home';\nvar Home = function Home() {\n  var _useState = useState({\n      'G - FGTS': '29870',\n      'C e M - INSS PORTABILIDADE ATUALIZADA FILE': '78025',\n      'M - UNIFICADA GRUPO SP - GOV/PME/SPPREV': '80797',\n      'G - INSS PORTABILIDADE': '69098',\n      'C - BASE FILE PORT INBURSA/CREFISA': '83106',\n      'I - TJSP': '62048',\n      'C e M - INBURSA PORTANDO D+ BANCOS PARA: ACIMA DE 500': '83752',\n      'G - PMESP AUMENTO 20%': '70014',\n      'M - GOV MT GERAL': '70967',\n      'C - INSS PORTABILIDADE INBURSA': '80802',\n      'G - PMSP - PREMIUM': '80801',\n      'M - SANTOS': '82286',\n      'I - BANCO MASTER SAQUE COMPL SEFAZ': '54283',\n      'G - PMSP AUMENTO 5%': '70015',\n      'G - OPORTUNIDADE INSS BANCO MASTER': '30730',\n      'C - INSS PORTABILIDADE CREFISA': '80803',\n      'S - UNIFICADA GRUPO SP - GOV/PME/SPPREV': '80798',\n      'I - PREF CURITIBA': '80595',\n      'M - GOV PARANA SAQUE COMPLEMENTAR MASTER': '79162',\n      'G - MARGEM REAL CARTÃO BENEFÍCIO MCC GOVSP': '70034',\n      'I - PM BETIM': '60139',\n      'G - GOV MARANHAO CARTAO BENEFICIO': '59136',\n      'G - GOV MG - GERAL': '55691',\n      'G - GOV PE': '51370',\n      'G - MT GROSSO DO SUL GERAL': '50943',\n      'G - SAQUE COMPLEMENTAR DAYCOVAL ACIMA 1000': '50008',\n      'G - REFIN SANTANDER | REDUÇÃO TAXA | PUBLICOS': '45169',\n      'G - SAQUE COMPLEMENTAR BANCO MASTER ATUALIZADO': '41975',\n      'G - COMLURB SANT': '41000',\n      'G - REFIN SANTANDER UNIFICADA': '38247',\n      'G - GOV SANTA CATARINA': '37114',\n      'G - GOV RJ CORRENTISTAS': '35994',\n      'G - OSASCO': '33270',\n      'G - 50 + VENDIDOS MARGEM ONLINE': '33263'\n    }),\n    bases = _useState[0];\n  var _useState2 = useState(true),\n    loading = _useState2[0],\n    setLoading = _useState2[1];\n  var _useState3 = useState({}),\n    baseData = _useState3[0],\n    setBaseData = _useState3[1];\n  var _useState4 = useState(null),\n    expandedBase = _useState4[0],\n    setExpandedBase = _useState4[1]; // Estado para controlar a div expandida\n  var _useState5 = useState([]),\n    campanhasComAviso = _useState5[0],\n    setCampanhasComAviso = _useState5[1];\n  var _useState6 = useState(new Date()),\n    lastUpdate = _useState6[0],\n    setLastUpdate = _useState6[1];\n  useEffect(function () {\n    function fetchData() {\n      return _fetchData.apply(this, arguments);\n    }\n    function _fetchData() {\n      _fetchData = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n        var newData, baseName, id, response, filteredData, temPorcentagemMaiorQue90;\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                _context.prev = 0;\n                newData = {};\n                _context.t0 = _regeneratorRuntime.keys(bases);\n              case 3:\n                if ((_context.t1 = _context.t0()).done) {\n                  _context.next = 15;\n                  break;\n                }\n                baseName = _context.t1.value;\n                id = bases[baseName];\n                _context.next = 8;\n                return axios.get(\"https://3c.fluxoti.com/api/v1/campaigns/\".concat(id, \"/lists?api_token=d0NLCpTnvtsY1gQu7S38RyF47fOjnHknynBjGzWxCwpXOJqXaNwWDrGqFomq\"));\n              case 8:\n                response = _context.sent;\n                filteredData = response.data.data.filter(function (post) {\n                  return post.weight === 1;\n                });\n                newData[id] = filteredData;\n                temPorcentagemMaiorQue90 = filteredData.some(function (post) {\n                  return parseFloat(post.completed_percentage) > 90;\n                });\n                if (temPorcentagemMaiorQue90) {\n                  campanhasComAviso.push(id);\n                }\n                _context.next = 3;\n                break;\n              case 15:\n                setCampanhasComAviso(campanhasComAviso);\n                setBaseData(newData);\n                setLoading(false);\n                setLastUpdate(new Date());\n                _context.next = 25;\n                break;\n              case 21:\n                _context.prev = 21;\n                _context.t2 = _context[\"catch\"](0);\n                console.error('Erro ao buscar os dados:', _context.t2);\n                setLoading(false);\n              case 25:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, null, [[0, 21]]);\n      }));\n      return _fetchData.apply(this, arguments);\n    }\n    fetchData();\n    var interval = setInterval(fetchData, 5 * 1 * 1000); // Recarrega a cada 60 minutos\n\n    return function () {\n      return clearInterval(interval);\n    }; // Limpa o temporizador quando o componente é desmontado   \n  }, [bases]);\n  function renderPorcentagem(porcentagem) {\n    var porcentagemNum = parseFloat(porcentagem);\n    if (porcentagemNum === 100) {\n      var porcentagemFormatada = porcentagemNum.toFixed(0);\n      return __jsx(\"span\", {\n        className: \"porcentagem-azul\"\n      }, porcentagemFormatada, \"%\");\n    } else if (porcentagemNum >= 90 && porcentagemNum <= 99.99) {\n      var _porcentagemFormatada = porcentagemNum.toFixed(0);\n      return __jsx(\"span\", {\n        className: \"porcentagem-vermelha\"\n      }, _porcentagemFormatada, \"%\");\n    } else {\n      var _porcentagemFormatada2 = porcentagemNum.toFixed(0);\n      return __jsx(\"span\", {\n        className: \"porcentagem-verde\"\n      }, _porcentagemFormatada2, \"%\");\n    }\n  }\n  function toggleDetails(id) {\n    if (expandedBase === id) {\n      setExpandedBase(null);\n    } else {\n      setExpandedBase(id);\n    }\n  }\n  return __jsx(CardContent, null, __jsx(\"div\", {\n    className: \"title\"\n  }, __jsx(\"h1\", null, \"CAMPANHAS\"), loading ? __jsx(\"p\", null, \"Carregando...\") : __jsx(\"div\", {\n    className: \"principalContent\"\n  }, Object.keys(bases).map(function (baseName) {\n    var _baseData$bases$baseN;\n    return __jsx(\"div\", {\n      key: baseName,\n      className: \"campaign-card\".concat(expandedBase === bases[baseName] ? ' clicked' : ''),\n      onClick: function onClick() {\n        return toggleDetails(bases[baseName]);\n      }\n    }, __jsx(\"div\", {\n      className: \"base \".concat(campanhasComAviso.includes(bases[baseName]) ? 'com-aviso' : '')\n    }, baseName), expandedBase === bases[baseName] && __jsx(\"div\", {\n      className: \"campaign-percentages\"\n    }, (_baseData$bases$baseN = baseData[bases[baseName]]) === null || _baseData$bases$baseN === void 0 ? void 0 : _baseData$bases$baseN.map(function (post) {\n      return __jsx(Container, {\n        key: post.id\n      }, __jsx(\"div\", {\n        className: \"percentage-item \".concat(parseFloat(post.completed_percentage) > 90 ? 'com-aviso' // Adiciona uma classe \"com-aviso\" se a porcentagem for maior que 90\n        : '')\n      }, __jsx(\"h3\", null, post.name), __jsx(\"p\", null, post.created_at), __jsx(\"h3\", {\n        className: \"porcentagem-\".concat(post.completed_percentage === '100.00' ? 'verde' : 'vermelha')\n      }, renderPorcentagem(post.completed_percentage)), __jsx(\"p\", null, \"\\xDAltima atualiza\\xE7\\xE3o: \", lastUpdate.toLocaleTimeString())));\n    })));\n  }))));\n};\nexport default Home;","map":null,"metadata":{},"sourceType":"module"}